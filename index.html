<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Role-Based Admin Dashboard</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>

<!-- LOGIN PANEL -->
<div id="login-panel" class="panel">
  <h2>🔐 Login</h2>
  <input id="login-email" type="email" placeholder="Email" required />
  <input id="login-password" type="password" placeholder="Password" required />
  <button id="login-btn">Login</button>
  <p id="login-msg"></p>
</div>

<!-- ADMIN PANEL -->
<div id="admin-panel" class="panel hidden">
  <h2>👑 Admin Dashboard</h2>
  <p id="admin-msg"></p>
  <button class="logout-btn" id="logout-btn">Logout</button>

  <!-- MAIN TABS -->
  <div class="main-tab-buttons">
    <button data-main="user-section" class="main-tab active">👥 Users</button>
    <button data-main="equipment-section" class="main-tab">🛠 Equipment</button>
    <button data-main="rigging-section" class="main-tab">🪝 Rigging</button>
  </div>

  <!-- USER SECTION -->
  <div id="user-section" class="main-section">
    <div class="sub-tab-buttons">
      <button data-target="add-user-sub" class="user-subtab active">➕ Add User</button>
      <button data-target="user-control-sub" class="user-subtab">🧑‍💼 User Control</button>
      <button data-target="user-logs-sub" class="user-subtab">📓 User Logs</button>
    </div>

    <div id="add-user-sub" class="user-subsection">
      <h3>Add New User</h3>
      <form id="add-user-form">
        <input id="new-name" type="text" name="name" placeholder="Name" required />
        <input id="new-email" type="email" name="email" placeholder="Email" required />
        <select id="new-role" name="role" required>
          <option value="" disabled selected>Select Role</option>
          <option value="user">User</option>
          <option value="moderator">Moderator</option>
          <option value="admin">Admin</option>
        </select>
        <button type="submit">Add User</button>
      </form>
      <p id="add-user-msg"></p>
    </div>

    <div id="user-control-sub" class="user-subsection hidden">
      <h3>🧑‍💼 Modify + Delete Users</h3>
      <div id="user-control-list"><p>Loading users...</p></div>
    </div>

    <div id="user-logs-sub" class="user-subsection hidden">
      <h3>📓 User Logs</h3>
      <!-- Changed from <div> to <ul> for cleaner row formatting -->
      <ul class="user-log-list" id="user-logs-list">
        <li>
          <span class="log-username">Loading...</span>
          <span class="log-role"></span>
          <span class="log-status"></span>
          <span class="log-lastseen"></span>
        </li>
      </ul>
    </div>
  </div>

<!-- EQUIPMENT SECTION -->
<div id="equipment-section" class="main-section hidden">

  <div class="equip-menu">
    <div class="equip-menu-group" data-group="dashboard">
      📊 Dashboard <span class="arrow">▶</span>
    </div>
    <div class="equip-submenu hidden" data-parent="dashboard">
      <button data-target="equip-dashboard">Show Summary</button>
    </div>

    <div class="equip-menu-group" data-group="manage">
      🛠 Manage <span class="arrow">▶</span>
    </div>
    <div class="equip-submenu hidden" data-parent="manage">
      <button data-target="equip-upload">⬆ Upload</button>
      <button data-target="equip-list">📋 List</button>
      <button data-target="equip-edit">✏️ Edit</button>
    </div>

    <div class="equip-menu-group" data-group="control">
      ⚙ Control <span class="arrow">▶</span>
    </div>
    <div class="equip-submenu hidden" data-parent="control">
    </div>
  </div>

  <!-- Dashboard subsection -->
  <div id="equip-dashboard" class="equip-subsection hidden">
    <div id="equipment-dashboard-summary">
      <h3>📊 Equipment Summary</h3>
      <h4>Crane</h4>
      <ul>
        <li>Crawler Cranes: <span id="stat-crawler"></span></li>
        <li>Mobile Cranes: <span id="stat-mobile"></span></li>
      </ul>
      <h4>Manlift</h4>
      <ul id="manlift-sizes-list"></ul>
      <button id="refresh-dashboard-btn">🔄 Refresh Dashboard</button>
    </div>
  </div>

  <!-- Upload subsection -->
  <div id="equip-upload" class="equip-subsection hidden">
    <h3>⬆ Upload Equipment CSV</h3>
    <div class="csv-upload-box">
      <label><strong>Upload CSV:</strong></label>
      <input id="csvFile" type="file" accept=".csv" />
      <button id="uploadCsvBtn" type="button">Upload</button>
      <div id="csv-status"></div>
    </div>
    <div id="equipment-table"><p>No data loaded yet.</p></div>
  </div>

  <!-- List subsection -->
  <div id="equip-list" class="equip-subsection hidden">
    <h3 class="flex-between">
      <span>📋 Equipment List</span>
      <div class="dropdown-wrapper">
        <button id="download-btn" type="button">Download ▼</button>
        <ul id="download-menu" class="download-menu">
          <li data-format="csv">Download CSV</li>
          <li data-format="pdf">Download PDF</li>
          <li data-format="image">Download Image</li>
        </ul>
      </div>
    </h3>
    <div id="manage-table-container">Loading...</div>
  </div>

  <!-- Edit subsection -->
  <div id="equip-edit" class="equip-subsection hidden">
    <h3>✏️ Edit Equipment</h3>
    <div id="edit-table-container">Loading...</div>
  </div>

</div>

<!-- RIGGING SECTION -->
<div id="rigging-section" class="main-section hidden">
  <div class="sub-tab-buttons">
    <button data-target="rigging-details" class="rigging-subtab active">📄 Rigging Details</button>
    <button data-target="rigging-logs" class="rigging-subtab">📓 Rigging Logs</button>
  </div>
  <div id="rigging-details" class="rigging-subsection">
    <div class="coming-soon-card"><span>🪝</span> Rigging Details coming soon</div>
  </div>
  <div id="rigging-logs" class="rigging-subsection hidden">
    <div class="coming-soon-card"><span>📓</span> Rigging Logs coming soon</div>
  </div>
</div>
</div>

<!-- USER PANEL -->
<div id="user-panel" class="panel hidden">
  <h2>👤 User Dashboard</h2>
  <p>Welcome, <span id="user-email"></span>.</p>
  <button class="logout-btn">Logout</button>
</div>

<div id="moderator-panel" class="panel hidden">
  <h2>🛡 Moderator Dashboard</h2>
  <p>Welcome, <span id="moderator-email"></span>.</p>
  <button class="logout-btn" id="logout-btn">Logout</button>

  <!-- Main Tabs: Crane / Manlift -->
  <div class="main-tab-buttons">
    <button data-main="moderator-crane-section" class="main-tab active">🚧 Crane</button>
    <button data-main="moderator-manlift-section" class="main-tab">🛗 Manlift</button>
  </div>

  <!-- ================= Crane Section ================= -->
  <div id="moderator-crane-section" class="main-section">
    <div class="sub-tab-buttons">
      <button data-target="crane-status-sub" class="crane-subtab active">📊 Status</button>
      <button data-target="crane-location-sub" class="crane-subtab">📍 Location</button>
      <button data-target="crane-rigger-sub" class="crane-subtab">🪝 Rigger</button>
    </div>

    <!-- Crane Status Sub-section -->
    <div id="crane-status-sub" class="crane-subsection">
      <form id="crane-status-form" onsubmit="return false;">
        <label>Registration No:</label><br>
        <input class="reg_no" placeholder="Reg No">
        <button type="button" id="crane-search-btn">Search</button><br><br>

        <label>Plant No:</label><br>
        <input class="plant_no" placeholder="Plant No" readonly><br><br>

        <label>Description:</label><br>
        <input class="description" placeholder="Description" readonly><br><br>

        <label>Action:</label><br>
        <select class="action" id="crane-action">
          <option value="breakdown">Breakdown</option>
          <option value="repair">Repair</option>
        </select><br><br>

        <div id="crane-reason-block" style="display:none;">
          <label>Reason:</label><br>
          <textarea class="reason" placeholder="Reason"></textarea><br><br>
        </div>

        <label>Date & Time:</label><br>
        <input class="date" type="datetime-local"><br><br>

        <button type="button" id="crane-submit-btn">Submit</button>
      </form>
    </div>

    <!-- Crane Other Sub-tabs -->
    <div id="crane-location-sub" class="crane-subsection hidden">Crane location content</div>
    <div id="crane-rigger-sub" class="crane-subsection hidden">Crane rigger content</div>
  </div>

  <!-- ================= Manlift Section ================= -->
  <div id="moderator-manlift-section" class="main-section hidden">
    <div class="sub-tab-buttons">
      <button data-target="manlift-status-sub" class="manlift-subtab active">📊 Status</button>
      <button data-target="manlift-location-sub" class="manlift-subtab">📍 Location</button>
      <button data-target="manlift-banksman-sub" class="manlift-subtab">🪙 Banksman</button>
    </div>

    <!-- Manlift Status Sub-section -->
    <div id="manlift-status-sub" class="manlift-subsection">
      <form id="manlift-status-form" onsubmit="return false;">
        <label>Registration No:</label><br>
        <input class="reg_no" placeholder="Reg No">
        <button type="button" id="manlift-search-btn">Search</button><br><br>

        <label>Plant No:</label><br>
        <input class="plant_no" placeholder="Plant No" readonly><br><br>

        <label>Description:</label><br>
        <input class="description" placeholder="Description" readonly><br><br>

        <label>Action:</label><br>
        <select class="action" id="manlift-action">
          <option value="breakdown">Breakdown</option>
          <option value="repair">Repair</option>
        </select><br><br>

        <div id="manlift-reason-block" style="display:none;">
          <label>Reason:</label><br>
          <textarea class="reason" placeholder="Reason"></textarea><br><br>
        </div>

        <label>Date & Time:</label><br>
        <input class="date" type="datetime-local"><br><br>

        <button type="button" id="manlift-submit-btn">Submit</button>
      </form>
    </div>

    <!-- Manlift Other Sub-tabs -->
    <div id="manlift-location-sub" class="manlift-subsection hidden">Manlift location content</div>
    <div id="manlift-banksman-sub" class="manlift-subsection hidden">Manlift banksman content</div>
  </div>
</div>

<!-- JS imports -->
<script type="module" src="./moderator.js"></script>




<!-- SCRIPTS -->
<script type="module" src="./main.js"></script>
<script type="module" src="./login.js"></script>
<script type="module" src="./admin.js"></script>
<script type="module" src="./user-control-main.js"></script>
<script type="module" src="./add-user.js"></script>
<script type="module" src="./user-control.js"></script>
<script type="module" src="./user-logs.js"></script>
<script type="module" src="./equipment-control.js"></script>
<script type="module" src="./equipment-dashboard.js"></script>
<script type="module" src="./equipment-list.js"></script>
<script type="module" src="./equipment-manage.js"></script>
<script type="module" src="./rigging-control.js"></script>
<script type="module" src="./rigging-details.js"></script>
<script type="module" src="./rigging-logs.js"></script>
<script type="module" src="./crane-status.js"></script>
<script type="module" src="./manlift-status.js"></script>

</body>
</html>
